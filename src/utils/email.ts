import nodemailer from "nodemailer";

export let emailTransporter: nodemailer.Transporter;

export const setupEmailTransporter = () => {
  if (process.env.NODE_ENV === "production") {
    emailTransporter = nodemailer.createTransport({
      host: "smtp.gmail.com",
      port: 465,
      secure: true,
      auth: { user: process.env.SENDER_EMAIL, pass: process.env.SENDER_PASSWORD },
    });
  }
};

export const validateEmail = (mail: string) => {
  return /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/.test(mail);
};

export const getEmailTemplate = (code: string) => `
<table style="background-color:#ffffff;padding-top:20px;color:#434245;width:100%;border:0;text-align:center;border-collapse:collapse" class="m_-9134756883115154329background_main"><tbody><tr><td style="vertical-align:top;padding:0"><center><table id="m_-9134756883115154329body" style="border:0;border-collapse:collapse;margin:0 auto;background:white;border-radius:8px;margin-bottom:16px"><tbody><tr><td style="width:546px;vertical-align:top;padding-top:32px"><div style="max-width:600px;margin:0 auto"><div style="margin-left:50px;margin-right:50px;margin-bottom:72px;margin-bottom:30px" class="m_-9134756883115154329lg_margin_left_right m_-9134756883115154329xl_margin_bottom"><div style="margin-top:18px" class="m_-9134756883115154329slack_logo_style"><img width="120" height="36" style="margin-top:0;margin-right:0;margin-bottom:32px;margin-left:0px" src="https://ci6.googleusercontent.com/proxy/ZGKcmCKHb3JYfH2bte1u2ZaKRohZh0EvGkh41BoH7oAzDNXB4yuNGuLyiC0PUUjVDrcSxjtue1lYoRcTXFCjXzZ5a8vQvG8A4Zgazg=s0-d-e1-ft#https://slack.com/x-a3603976840148/img/slack_logo_240.png" alt="slack logo" class="CToWUd"></div><h1>Confirm your email address</h1><p style="font-size:20px;line-height:28px;letter-spacing:-0.2px;margin-bottom:28px;word-break:break-word" class="m_-9134756883115154329hero_paragraph"> Your confirmation code is below — enter it in your open browser window and we'll help you get signed in. </p></div><div style="background:#f5f4f5;border-radius:4px;padding:43px 23px;margin-left:50px;margin-right:50px;margin-bottom:72px;margin-bottom:30px" class="m_-9134756883115154329lg_margin_left_right m_-9134756883115154329xl_margin_bottom m_-9134756883115154329grey_box_container"><div style="text-align:center;vertical-align:middle;font-size:30px">${code}</div></div><div style="margin-left:50px;margin-right:50px;margin-bottom:72px;margin-bottom:30px" class="m_-9134756883115154329lg_margin_left_right m_-9134756883115154329xl_margin_bottom"><p style="font-size:16px;line-height:24px;letter-spacing:-0.2px;margin-bottom:28px" class="m_-9134756883115154329content_paragraph"></p><p style="font-size:16px;line-height:24px;letter-spacing:-0.2px;margin-bottom:28px" class="m_-9134756883115154329content_paragraph">If you didn’t request this email, there’s nothing to worry about — you can safely ignore it.</p></div></div></td></tr></tbody></table></center></td></tr><tr><td class="m_-9134756883115154329email_footer" style="font-size:15px;color:#717274;text-align:center;width:100%"><center><table style="margin:20px auto 0;background-color:white;border:0;text-align:center;border-collapse:collapse"><tbody><tr><td style="width:546px;vertical-align:top;padding:0px"><div style="max-width:600px;margin:0 auto"><div style="padding:0 50px"><table><tbody><tr><td style="vertical-align:top;text-align:left"><img width="120" height="36" style="margin-top:0;margin-right:0;margin-bottom:32px;margin-left:0px" src="https://ci6.googleusercontent.com/proxy/ZGKcmCKHb3JYfH2bte1u2ZaKRohZh0EvGkh41BoH7oAzDNXB4yuNGuLyiC0PUUjVDrcSxjtue1lYoRcTXFCjXzZ5a8vQvG8A4Zgazg=s0-d-e1-ft#https://slack.com/x-a3603976840148/img/slack_logo_240.png" alt="slack logo" class="CToWUd"></td><td style="vertical-align:top;text-align:right"><a href="https://twitter.com/slackhq" style="margin-left:32px" target="_blank" data-saferedirecturl="https://www.google.com/url?q=https://twitter.com/slackhq&amp;source=gmail&amp;ust=1654103143422000&amp;usg=AOvVaw042CVOsx_jOBlsg3bzYoYU"><img src="https://ci3.googleusercontent.com/proxy/W9VGTw4K1XYyPGFX5p9qO4Onc0I3HVz7jvLv1joMdghyijEfVN9D-IYXGAPsuiYB2exhJOeQKMamzh6eM1NJS6kppc0j79n-weyW7daMi_av7SiBLKZXxRVpUdI4SOYs=s0-d-e1-ft#https://a.slack-edge.com/b8be608/marketing/img/icons/icon_colored_twitter.png" width="32" height="32" title="Twitter" class="CToWUd"></a><a href="https://facebook.com/slackhq" style="margin-left:32px" target="_blank" data-saferedirecturl="https://www.google.com/url?q=https://facebook.com/slackhq&amp;source=gmail&amp;ust=1654103143422000&amp;usg=AOvVaw3MuoOkIH0hI-DBVInSK2Lp"><img src="https://ci5.googleusercontent.com/proxy/4MPp8ZT9T9bGo_-GbffzPt76cT7mYJAOAzOvZEI1Oyb8wRtf9tR8EuNPNj3DTV82bvpse64nNQhX4gDaOh3ox7XK2ZkTszFHZBu4vFvdF-_gIv9-8BYwGIu7LnUFvU9Cdg=s0-d-e1-ft#https://a.slack-edge.com/b8be608/marketing/img/icons/icon_colored_facebook.png" width="32" height="32" title="Facebook" class="CToWUd"></a><a href="https://www.linkedin.com/company/tiny-spec-inc/" style="margin-left:32px" target="_blank" data-saferedirecturl="https://www.google.com/url?q=https://www.linkedin.com/company/tiny-spec-inc/&amp;source=gmail&amp;ust=1654103143422000&amp;usg=AOvVaw1YnuW93WUBrDtbNqD4tYW_"><img src="https://ci3.googleusercontent.com/proxy/uyzUcsRXlGvU0avQztKemD0Pas-VJx26-bl6uNMbAJr3jOZAK2KFvdX6xoKA5l-gRqR_H7Yhrc-Jvfy6niN3zkx4oP1pnDdrgE0UCODfKXAlL2jSoKg3mzv1GH-a96uP2A=s0-d-e1-ft#https://a.slack-edge.com/b8be608/marketing/img/icons/icon_colored_linkedin.png" width="32" height="32" title="LinkedIn" class="CToWUd"></a></td></tr></tbody></table><div style="font-size:12px;opacity:0.5;color:#696969;text-align:left;line-height:15px;margin-bottom:50px;text-align:left"><a class="m_-9134756883115154329footer_link" href="https://slackhq.com" style="color:#696969!important" target="_blank" data-saferedirecturl="https://www.google.com/url?q=https://slackhq.com&amp;source=gmail&amp;ust=1654103143422000&amp;usg=AOvVaw33hWMXt3cURlL2w4_h4hYc">Our Blog</a>&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;<a class="m_-9134756883115154329footer_link" href="https://slack.com/legal" style="color:#696969!important" target="_blank" data-saferedirecturl="https://www.google.com/url?q=https://slack.com/legal&amp;source=gmail&amp;ust=1654103143422000&amp;usg=AOvVaw0pSlwd8oi2vfQfR5c1TSlb">Policies</a>&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;<a href="https://slack.com/help" class="m_-9134756883115154329footer_link" style="color:#696969!important" target="_blank" data-saferedirecturl="https://www.google.com/url?q=https://slack.com/help&amp;source=gmail&amp;ust=1654103143422000&amp;usg=AOvVaw1OCqZhKQOP77VW1hIpyJrE">Help Center</a>&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;<a href="https://slack.com/community" class="m_-9134756883115154329footer_link" style="color:#696969!important" target="_blank" data-saferedirecturl="https://www.google.com/url?q=https://slack.com/community&amp;source=gmail&amp;ust=1654103143422000&amp;usg=AOvVaw1n8Qj2f1ZewSZ9gkQDCf4n">Slack Community</a><br><br><div>©2021 Slack Technologies, LLC, a Salesforce company.<br>500 Howard Street, San Francisco, CA 94105 USA</div><br>All rights reserved.</div></div></div></td></tr></tbody></table></center></td></tr></tbody></table>
`;
